<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Visa News Summary</title>
</head>
<body style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; line-height: 1.6; color: #333; margin: 0; padding: 0; background-color: #f5f5f5;">
    <!-- Outer container -->
    <table width="100%" cellpadding="0" cellspacing="0" border="0">
    <tr><td align="center" style="padding: 20px;">
    <table width="700" cellpadding="0" cellspacing="0" border="0" style="max-width: 700px;">

        <!-- Header -->
        <tr>
            <td style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); background-color: #667eea; color: white; padding: 30px 20px; text-align: center; border-radius: 8px 8px 0 0;">
                <h1 style="margin: 0; font-size: 1.8em; font-weight: 300;">Visa News Summary</h1>
                <p style="margin: 8px 0 0 0; opacity: 0.9; font-size: 0.95em;">{{ date }}</p>
            </td>
        </tr>

        <!-- Body -->
        <tr>
            <td style="background: white; padding: 25px; border-radius: 0 0 8px 8px;">

                <!-- Stats row as table -->
                <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom: 20px; border: 1px solid #e1e8ed; border-radius: 8px; border-collapse: separate;">
                    <tr>
                        <td width="33%" style="text-align: center; padding: 16px 10px;">
                            <div style="font-size: 1.6em; font-weight: 700; color: #e74c3c;">{{ needs_attention|length }}</div>
                            <div style="font-size: 0.8em; color: #7f8c8d; margin-top: 2px;">Needs Attention</div>
                        </td>
                        <td width="34%" style="text-align: center; padding: 16px 10px; border-left: 1px solid #e1e8ed; border-right: 1px solid #e1e8ed;">
                            <div style="font-size: 1.6em; font-weight: 700; color: #f39c12;">{{ good_to_know|length }}</div>
                            <div style="font-size: 0.8em; color: #7f8c8d; margin-top: 2px;">Good to Know</div>
                        </td>
                        <td width="33%" style="text-align: center; padding: 16px 10px;">
                            <div style="font-size: 1.6em; font-weight: 700; color: #95a5a6;">{{ no_attention|length }}</div>
                            <div style="font-size: 0.8em; color: #7f8c8d; margin-top: 2px;">General</div>
                        </td>
                    </tr>
                </table>

                <!-- Daily summary -->
                <div style="color: #555; font-size: 0.95em; margin-bottom: 25px; padding: 12px 16px; background: #f8f9fa; border-left: 3px solid #667eea;">{{ daily_summary }}</div>

                <!-- Needs Attention -->
                {% if needs_attention %}
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 1.1em; font-weight: 600; color: #e74c3c; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #e74c3c;">Needs Attention</div>
                    {% for article in needs_attention %}
                    <div style="padding: 10px 0;{% if not loop.first %} border-top: 1px solid #f0f0f0;{% endif %}">
                        <div style="font-weight: 500; color: #2c3e50; font-size: 0.95em;">
                            {% if article.url %}<a href="{{ article.url }}" target="_blank" style="color: #2c3e50; text-decoration: none;">{{ article.title }}</a>{% else %}{{ article.title }}{% endif %}
                        </div>
                        {% if article.summary %}
                        <div style="color: #666; font-size: 0.88em; margin-top: 4px; line-height: 1.5;">{{ article.summary }}</div>
                        {% endif %}
                        <div style="font-size: 0.78em; color: #999; margin-top: 4px;">
                            {{ article.published_at.strftime('%b %d, %Y') }}
                            {% if article.analysis_result and article.analysis_result.deadline %}
                            &middot; <span style="color: #e74c3c; font-weight: 600;">Deadline: {{ article.analysis_result.deadline }}</span>
                            {% endif %}
                            {% if article.analysis_result and article.analysis_result.affected_visa_types %}
                            &middot; <span style="color: #667eea;">{{ article.analysis_result.affected_visa_types | join(', ') }}</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Good to Know -->
                {% if good_to_know %}
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 1.1em; font-weight: 600; color: #e67e22; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #f39c12;">Good to Know</div>
                    {% for article in good_to_know %}
                    <div style="padding: 10px 0;{% if not loop.first %} border-top: 1px solid #f0f0f0;{% endif %}">
                        <div style="font-weight: 500; color: #2c3e50; font-size: 0.95em;">
                            {% if article.url %}<a href="{{ article.url }}" target="_blank" style="color: #2c3e50; text-decoration: none;">{{ article.title }}</a>{% else %}{{ article.title }}{% endif %}
                        </div>
                        {% if article.summary %}
                        <div style="color: #666; font-size: 0.88em; margin-top: 4px; line-height: 1.5;">{{ article.summary }}</div>
                        {% endif %}
                        <div style="font-size: 0.78em; color: #999; margin-top: 4px;">
                            {{ article.published_at.strftime('%b %d, %Y') }}
                            {% if article.analysis_result and article.analysis_result.affected_visa_types %}
                            &middot; <span style="color: #667eea;">{{ article.analysis_result.affected_visa_types | join(', ') }}</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- General Information -->
                {% if no_attention %}
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 1.1em; font-weight: 600; color: #7f8c8d; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #95a5a6;">General Information</div>
                    {% for article in no_attention %}
                    <div style="padding: 10px 0;{% if not loop.first %} border-top: 1px solid #f0f0f0;{% endif %}">
                        <div style="font-weight: 500; color: #2c3e50; font-size: 0.95em;">
                            {% if article.url %}<a href="{{ article.url }}" target="_blank" style="color: #2c3e50; text-decoration: none;">{{ article.title }}</a>{% else %}{{ article.title }}{% endif %}
                        </div>
                        <div style="font-size: 0.78em; color: #999; margin-top: 4px;">
                            {{ article.published_at.strftime('%b %d, %Y') }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

            </td>
        </tr>

        <!-- Footer -->
        <tr>
            <td style="text-align: center; padding: 15px; color: #aaa; font-size: 0.8em;">
                Automatically generated by Visa News Tracker
            </td>
        </tr>

    </table>
    </td></tr>
    </table>
</body>
</html>
